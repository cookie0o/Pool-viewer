import{c as w,a as x,t as ce}from"../chunks/C-TkrDIZ.js";import{i as de}from"../chunks/D0H1u2mU.js";import{q as _,s as M,f as O,n as S,W as h,T as R,k as y,v as l,x as u,w as c,as as $,t as pe}from"../chunks/BRidpAwb.js";import{s as T}from"../chunks/CySQt-tR.js";import{o as me}from"../chunks/CuDHcO3f.js";import{b as ue}from"../chunks/Cx8CNsX4.js";import{I as P,L as ve}from"../chunks/B-6fwPC1.js";import{b as G}from"../chunks/DFtZBgu2.js";import{s as H}from"../chunks/CVAmKEYq.js";import{s as I,r as N}from"../chunks/BlYlK6Qh.js";function he(t,s){_(s,!0);let o=N(s,["$$slots","$$events","$$legacy"]);P(t,I({name:"clock"},()=>o,{iconNode:[["circle",{cx:"12",cy:"12",r:"10"}],["polyline",{points:"12 6 12 12 16 14"}]],children:(r,a)=>{var e=w(),n=O(e);H(n,()=>s.children??S),x(r,e)},$$slots:{default:!0}})),M()}function fe(t,s){_(s,!0);let o=N(s,["$$slots","$$events","$$legacy"]);P(t,I({name:"hash"},()=>o,{iconNode:[["line",{x1:"4",x2:"20",y1:"9",y2:"9"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21"}]],children:(r,a)=>{var e=w(),n=O(e);H(n,()=>s.children??S),x(r,e)},$$slots:{default:!0}})),M()}function ge(t,s){_(s,!0);let o=N(s,["$$slots","$$events","$$legacy"]);P(t,I({name:"microchip"},()=>o,{iconNode:[["path",{d:"M18 12h2"}],["path",{d:"M18 16h2"}],["path",{d:"M18 20h2"}],["path",{d:"M18 4h2"}],["path",{d:"M18 8h2"}],["path",{d:"M4 12h2"}],["path",{d:"M4 16h2"}],["path",{d:"M4 20h2"}],["path",{d:"M4 4h2"}],["path",{d:"M4 8h2"}],["path",{d:"M8 2a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2h-1.5c-.276 0-.494.227-.562.495a2 2 0 0 1-3.876 0C9.994 2.227 9.776 2 9.5 2z"}]],children:(r,a)=>{var e=w(),n=O(e);H(n,()=>s.children??S),x(r,e)},$$slots:{default:!0}})),M()}function ye(t,s){_(s,!0);let o=N(s,["$$slots","$$events","$$legacy"]);P(t,I({name:"pickaxe"},()=>o,{iconNode:[["path",{d:"M14.531 12.469 6.619 20.38a1 1 0 1 1-3-3l7.912-7.912"}],["path",{d:"M15.686 4.314A12.5 12.5 0 0 0 5.461 2.958 1 1 0 0 0 5.58 4.71a22 22 0 0 1 6.318 3.393"}],["path",{d:"M17.7 3.7a1 1 0 0 0-1.4 0l-4.6 4.6a1 1 0 0 0 0 1.4l2.6 2.6a1 1 0 0 0 1.4 0l4.6-4.6a1 1 0 0 0 0-1.4z"}],["path",{d:"M19.686 8.314a12.501 12.501 0 0 1 1.356 10.225 1 1 0 0 1-1.751-.119 22 22 0 0 0-3.393-6.319"}]],children:(r,a)=>{var e=w(),n=O(e);H(n,()=>s.children??S),x(r,e)},$$slots:{default:!0}})),M()}function $e(t,s){_(s,!0);let o=N(s,["$$slots","$$events","$$legacy"]);P(t,I({name:"thumbs-up"},()=>o,{iconNode:[["path",{d:"M7 10v12"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z"}]],children:(r,a)=>{var e=w(),n=O(e);H(n,()=>s.children??S),x(r,e)},$$slots:{default:!0}})),M()}function xe(t,s){_(s,!0);let o=N(s,["$$slots","$$events","$$legacy"]);P(t,I({name:"x"},()=>o,{iconNode:[["path",{d:"M18 6 6 18"}],["path",{d:"m6 6 12 12"}]],children:(r,a)=>{var e=w(),n=O(e);H(n,()=>s.children??S),x(r,e)},$$slots:{default:!0}})),M()}function _e(t){return t>=1e6?(t/1e6).toFixed(2)+" MH/s":t>=1e3?(t/1e3).toFixed(2)+" KH/s":t.toFixed(2)+" H/s"}function Me(t,s){return t.length>s?t.substring(0,s)+"...":t}function Oe(t,s){const o=t*1e3;{const i=new Date,r=new Date(o),a=i.getTime()-r.getTime(),e=Math.floor(a/(1e3*60*60*24)),n=Math.floor(a%(1e3*60*60*24)/(1e3*60*60)),d=Math.floor(a%(1e3*60*60)/(1e3*60)),p=Math.floor(a%(1e3*60)/1e3),m=a%1e3;return e>0?`${e} day${e===1?"":"s"} ago`:n>0?`${n} hour${n===1?"":"s"} ago`:d>0?`${d} minute${d===1?"":"s"} ago`:p>0?`${p} second${p===1?"":"s"} ago`:`${m} millisecond${m===1?"":"s"} ago`}}function K(t){if(!t)return 0;const s={H:1,KH:1e3,MH:1e6,GH:1e9,TH:1e12,PH:1e15},o=t.trim().split(" ");if(o.length!==2)return 0;const[i,r]=o,a=s[r.toUpperCase()],e=parseFloat(i);return isNaN(e)||a===void 0?0:Math.round(e*a)}function F(t){if(!t)return 0;const[s]=t.trim().split(" "),o=parseInt(s,10);return isNaN(o)?0:o}let Z=0;function ke(t){var i;if(!((i=t==null?void 0:t.perWorkerStats)!=null&&i.length))return 0;const s=document.getElementById("miner-container");if(!s)return 0;const o=localStorage.getItem("sortingOrder");t.perWorkerStats.sort((r,a)=>{switch(o){case"1":return K(a.hashrate||"0 H")-K(r.hashrate||"0 H");case"2":return a.hashes-r.hashes;case"3":return F(a.expired||"0%")-F(r.expired||"0%");case"4":return F(a.invalid||"0%")-F(r.invalid||"0%");case"5":return a.lastShare-r.lastShare;default:return 0-K(r.hashrate||"0.00 H")}}),s.innerHTML="";for(const r of t.perWorkerStats){Z=1;const{workerId:a,hashrate:e,hashes:n,expired:d,invalid:p,lastShare:m}=r,E=e!==void 0?e:"0.00 H",f=p?parseInt(p):0,v=d?parseInt(d):0,k=f+v,L=n-f,U=n-v,C=L>0?(k/(L+U)*100).toFixed(2):"0.00",X=Me(a,10),j=Oe(m),g=document.createElement("div");g.className="miner-block card preset-filled-surface-100-900",g.innerHTML=`
      <div style="margin-top: 0px; height: 35px; border-radius: 5px; display: flex; justify-content: center; align-items: center;" class="card preset-filled-surface-100-900">
        <div class="grid grid-cols-6 gap-4 w-full text-center">
          <div style="display: flex; justify-content: center; align-items: center;">
            <p style="margin: 0;">xmrpool.eu</p>
          </div>
          <div style="display: flex; justify-content: center; align-items: center;">
            <p style="margin: 0;">${X}</p>
          </div>
          <div style="display: flex; justify-content: center; align-items: center;">
            <p style="margin: 0;">${E}/s</p>
          </div>
          <div style="display: flex; justify-content: center; align-items: center;">
            <p style="margin: 0;">${n}</p>
          </div>
          <div style="display: flex; justify-content: center; align-items: center;">
            <p style="margin: 0;">${k} (${C}%)</p>
          </div>
          <div style="display: flex; justify-content: center; align-items: center;">
            <p style="margin: 0;">${j}</p>
          </div>
        </div>
      </div>
    `,s.appendChild(g)}return Z}let Q=0;async function we(t){var r;const s=`monero_rate_${t}`,o=localStorage.getItem(s);if(o)try{const{rate:a,timestamp:e}=JSON.parse(o);if(Date.now()-e<36e5)return a}catch(a){console.warn("Failed to parse cached rate:",a)}const i=`https://api.coingecko.com/api/v3/simple/price?ids=monero&vs_currencies=${t}`;try{const e=await(await fetch(i)).json(),n=(r=e==null?void 0:e.monero)==null?void 0:r[t];return n!==void 0?(localStorage.setItem(s,JSON.stringify({rate:n,timestamp:Date.now()})),n):null}catch(a){return console.error("Error fetching Monero price:",a),null}}async function Se(t){const s=`https://web.xmrpool.eu:8119/stats_address?address=${t}&longpoll=false`,o=localStorage.getItem("dataTimestamp_XMRPOOLEU"),i=Date.now();try{if(!localStorage.getItem("XMRPOOLEU"))r=await(await fetch(s)).json();else var r=JSON.parse(localStorage.getItem("XMRPOOLEU")||"").data;if(o&&i-parseInt(o)<5*60*1e3?((localStorage.getItem("address")||"")!==r.address&&(r=await(await fetch(s)).json()),console.log("Data not 5 minutes old, using old data.")):r=await(await fetch(s)).json(),r.stats){const e=(parseFloat(r.stats.balance)/1e12).toFixed(7),n=r.stats.hashrate||"0",d=r.stats.paid||"",p=r.perWorkerStats&&Array.isArray(r.perWorkerStats)?r.perWorkerStats:[],m={balance:e,hashrate:n,payments:d,perWorkerStats:p,timestamp:i.toString(),data:r,address:t};return localStorage.setItem("XMRPOOLEU",JSON.stringify(m)),localStorage.setItem("dataTimestamp_XMRPOOLEU",i.toString()),console.log("Fetched new data. XMRPOOLEU"),Q=ke(m),Q}else console.error("Invalid data structure: XMRPOOLEU",r);return null}catch(a){return console.error("Error fetching Monero data: XMRPOOLEU",a),null}}var Pe=ce('<div style="display: flex; justify-content: space-between; gap: 16px; width: 100%; height: 90px;"><div class="card preset-filled-surface-100-900 p-2 text-center svelte-76ik6m" style="flex-grow: 0.5;"><h5 class="h5">Total Hashrate</h5> <div class="data-block svelte-76ik6m"><p class="value svelte-76ik6m"> </p></div></div> <div class="card preset-filled-surface-100-900 p-2 text-center svelte-76ik6m" style="flex-grow: 1;"><h5 class="h5">Pool Balance</h5> <div class="data-block svelte-76ik6m"><p class="value svelte-76ik6m"> </p> <span class="vr border-l-4"></span> <p class="value svelte-76ik6m"> </p></div></div></div> <p class="middle-text svelte-76ik6m"> </p> <div class="grid grid-cols-6 gap-4 w-full text-center svelte-76ik6m"><div class="labels svelte-76ik6m"><!> <p style="margin: 0;">Pool</p></div> <div class="labels svelte-76ik6m"><!> <p style="margin: 0;">Worker ID</p></div> <div class="labels svelte-76ik6m"><!> <p style="margin: 0;">Hashrate</p></div> <div class="labels svelte-76ik6m"><!> <p style="margin: 0;">Accepted Hashed</p></div> <div class="labels svelte-76ik6m"><!> <p style="margin: 0;">Bad Hashes</p></div> <div class="labels svelte-76ik6m"><!> <p style="margin: 0;">Last Share</p></div></div> <div id="miner-container"></div>',1);function Te(t,s){_(s,!1);let o="0",i=0,r=R("0"),a=R(0),e="eur",n=R(""),d=R(G[e]||e.toUpperCase()),p,m=R("Your Miner`s");me(async()=>{if(typeof window<"u"){let b=localStorage.getItem("address");if(b==null)window.location.replace(ue+"/settings"),alert("No Monero address defined.");else{p=await Se(b)||0,e=localStorage.getItem("currency")||"usd";const E=localStorage.getItem("XMRPOOLEU");if(E){const v=JSON.parse(E);i=v.balance,o=v.hashrate}else console.log("No data found for XMRPOOLEU");h(r,_e(parseInt(o))),h(a,i),h(d,G[e]||e.toUpperCase());const f=await we(e);f!==null?h(n,(y(a)*f).toFixed(2)):(h(n,"Error"),h(d,"")),p<1?h(m,"No Miner`s"):p==1?h(m,"Your Miner"):h(m,"Your ${miner_count} Miner's")}}}),de(),ve(t,{title:"Home",children:(b,E)=>{var f=Pe(),v=O(f),k=l(v),L=u(l(k),2),U=l(L),C=l(U,!0);c(U),c(L),c(k);var X=u(k,2),j=u(l(X),2),g=l(j),ee=l(g);c(g);var Y=u(g,4),te=l(Y,!0);c(Y),c(j),c(X),c(v);var W=u(v,2),se=l(W,!0);c(W);var z=u(W,2),A=l(z),re=l(A);ye(re,{class:"w-4 h-5.7 pr-[2px]"}),$(2),c(A);var J=u(A,2),ae=l(J);ge(ae,{class:"w-4 h-5.7 pr-[2px]"}),$(2),c(J);var B=u(J,2),ne=l(B);fe(ne,{class:"w-4 h-5.7 pr-[2px]"}),$(2),c(B);var D=u(B,2),oe=l(D);$e(oe,{class:"w-4 h-5.7 pr-[2px]"}),$(2),c(D);var V=u(D,2),ie=l(V);xe(ie,{class:"w-4 h-5.7 pr-[2px]"}),$(2),c(V);var q=u(V,2),le=l(q);he(le,{class:"w-4 h-5.7 pr-[2px]"}),$(2),c(q),c(z),$(2),pe(()=>{T(C,y(r)),T(ee,`${y(a)??""} XMR`),T(te,y(n)?`${y(n)} ${y(d)}`:"Loading..."),T(se,y(m))}),x(b,f)},$$slots:{default:!0}}),M()}export{Te as component};
